Task & Definition
Fix Fastify request augmentation so `request.auth` is typed in @memento/api and add safe narrowing for `unknown` errors in specified handlers to eliminate TS2339/TS18046.

Constraints/Risks
- Must respect monorepo depth limit (<=3 levels); avoid adding deep folders.
- Keep apps thin; minimal, focused changes in @memento/api.
- Avoid network; only local build/test. pnpm available.

Code Searches
- Command: nl -ba packages/api/src/APIGateway.ts | sed -n '380,520p'
  Purpose: Locate the failing `request.auth` usage around line 412.
  Result: Found `request.auth = authContext;`.
- Command: sed -n '1,200p' packages/api/src/types/fastify.d.ts
  Purpose: Verify augmentation exists.
  Result: Declares `FastifyRequest.auth?: AuthContext`.
- Command: cat packages/api/tsconfig.json
  Purpose: Ensure augmentation is included via `files`.
  Result: `files: ["src/types/fastify.d.ts"]` present.
- Command: nl -ba packages/api/src/mcp-router.ts | sed -n '1950,1990p'
  Purpose: Inspect lines flagged for TS18046.
  Result: Accessing `error.message` and `error.code` on `unknown`.
- Command: nl -ba packages/api/src/routes/tests.ts | sed -n '250,320p'
  Purpose: Inspect TS18046 in tests routes.
  Result: Same issue in multiple catch blocks.

Web Searches
- None (network disabled).

Implementation Notes
- Added `packages/api/src/types/index.d.ts` with `import 'fastify';` to force module augmentation inclusion.
- Removed failing `import type 'fastify'` from `APIGateway.ts` (TS1005 under current settings).
- Created `packages/api/src/error-utils.ts` with typed helpers `getErrorMessage` and `getErrorCode` (no `any`).
- Updated `mcp-router.ts` to use helpers and avoid direct property access on `unknown`.
- Updated `routes/tests.ts` to use helpers in catch blocks.

Validation Evidence
- Command: pnpm -r --filter @memento/api build > logs/latest-build-api.log 2>&1
  File: logs/latest-build-api.log
  Assertion: Build completes without TS2339 on `request.auth` and without TS18046 at the specified lines.
  Result: No errors reported.

Open Follow-ups
- Consider centralizing error helpers in a shared package if reused across apps, per DRY, once a second usage emerges beyond @memento/api.
- Audit other files in @memento/api for similar `unknown` error handling patterns (rg for `catch (error)`) and apply helpers if needed.
