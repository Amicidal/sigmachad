Task & Definition
- Remove file-level `security/detect-object-injection` disables in @memento/api and refactor dynamic property access to safe, whitelisted lookups. Target files: middleware/validation.ts, middleware/scopes.ts, routes/admin.ts, mcp-router.ts. Acceptance: no file-level disables; `pnpm -s lint` has zero error-level occurrences for this rule in API files.

Constraints/Risks
- Avoid breaking API behavior; keep JSON schema validation and sanitization semantics.
- ESLint security rule is sensitive to bracket property access; prefer Maps, switches, Reflect.get with whitelists.
- Monorepo limits and path depth rules apply; keep changes minimal.

Code Searches
- rg -n "^/\\* eslint-disable security/detect-object-injection \\*/" packages/api
  - Expect: list target files with file-level disables.
  - Observed: 4 files (validation.ts, scopes.ts, admin.ts, mcp-router.ts).
- rg -n "\\[[^'\\\"]*[^'\\\"]\\]" packages/api/src/mcp-router.ts
  - Expect: find dynamic bracket indexing hot spots.
  - Observed: args[paramName], summary.bySeverity[item.severity], cweMap[type], scores[severity], domainMap[patternKey], fileSets reducer, value[i].

Web Searches
- None (network restricted). Relied on local code analysis and prior knowledge of eslint-plugin-security patterns.

Implementation Notes
- scopes.ts: Replace Record with Map and add `resolveScopeAlias`; update `normalizeScopes` and `applyScopeAliases` to use it.
- validation.ts: Eliminate bracketed object construction using `Object.defineProperty` and `Object.create(null)`; add `isSafeKey`; switch rate-limit header access to a guarded helper.
- mcp-router.ts: Remove file-level disable; add `safeGetArg` (whitelist + Reflect.get); refactor parameter validation to use it; replace array index loop with `entries()`; convert domain mapping to regexâ†’domain pairs; replace severity/cwe lookups with switch/Map; replace union file summary reducer with Map.
- admin.ts: Remove file-level disable comment; rely on existing validation/sanitization.

Validation Evidence
- Command: pnpm -s lint > logs/latest-lint.log 2>&1
- Search: rg -n "detect-object-injection" logs/latest-lint.log
- Search: rg -n "^/\\* eslint-disable security/detect-object-injection \\*/" packages/api | wc -l

Open Follow-ups
- If any remaining non-critical lint warnings appear unrelated to object-injection, triage separately.
