Task & Definition
Resolve all security/detect-object-injection ESLint warnings in @memento/backup. Success = package passes eslint without object-injection findings; changes keep behavior identical.

Constraints/Risks
- Monorepo rules (path depth, imports) must remain satisfied.
- Avoid broad refactors; focus on eliminating computed property access on plain objects/arrays.
- No network access; rely on local toolchain. pnpm must not install.

Code Searches
- rg for TODO entry and sample lines:
  - cmd: rg -n "^## Task Backlog|### 30" TODO.md
  - result: Found task 30 with sample lines (848, 856, 871, 992, 2271, 2543, 2554, 2559) in BackupService.ts.
- enumerate backup package files:
  - cmd: rg --files packages/backup
  - result: 9 files including BackupService.ts, S3StorageProvider.ts, LocalFilesystemStorageProvider.ts.
- locate computed indexing in package:
  - cmd: rg -n "\\[[^\\]]+\\]" packages/backup/src -S --no-heading
  - result: Hits in BackupService.ts and S3StorageProvider.ts aligning with sample lines.

Web Searches
- None (network restricted).

Implementation Notes
- Replaced unsafe object indexing with safer patterns:
  - getString/Boolean/NumberOption: use Map(Object.entries(...)).get(key) instead of source[key].
  - Retention policy loop: avoid eligible[index].id; use slice().
  - sanitizeRowForBackup: build via Object.fromEntries rather than sanitized[key] writes.
  - mapUdtNameToSqlType: switch to Map.get(normalized) to avoid mapping[normalized].
  - extractCount: use .at(0) instead of [0].
  - restoreFalkorDB sanitizeProperties: collect entries and return Object.fromEntries; removed all sanitized[key] writes.
  - Postgres restore: avoid row[name] with Map(Object.entries(row)).get(name).
  - SQL dump parsing: use charAt instead of string indexing.
  - Use Object.keys(table.rows.at(0) ?? {}) instead of table.rows[0].
  - Regex match capture: use insertMatch.at(1) instead of insertMatch[1].
  - S3 sanitizeMetadata: construct object via Object.fromEntries.

Validation Evidence
- Ran: pnpm -w exec eslint packages/backup/src/**/*.ts -f json > logs/lints/backup-lint-2025-09-30-2328.json
- Result: 0 occurrences of ruleId "security/detect-object-injection" across files [BackupService.ts, BackupStorageProvider.ts, LocalFilesystemStorageProvider.ts, S3StorageProvider.ts, index.ts].
- Evidence file: logs/lints/backup-lint-2025-09-30-2328.json
- Note: Workspace lint still has unrelated warnings and a custom rule error (type-only import) not in scope for this task.

Open Follow-ups
- If eslint still flags array indexing or other patterns, consider rule configuration or further refactors (e.g., Maps for additional cases).
