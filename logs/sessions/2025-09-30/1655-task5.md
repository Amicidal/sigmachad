Task & Definition
- Implement TODO.md task 5 (ID: 2025-09-30.25): Reconcile security scanner types and agent API usage. Unify security types in @memento/shared-types, ensure VulnerabilityReport trends use SecurityTrends, and update SecurityFixAgent to call SecurityScanner.performScan(...).

Constraints/Risks
- Repo constraints: depth/import ceilings; prefer pnpm/Nx; no deep refactors beyond scope.
- Network restricted; rely on local toolchain and caches.
- Agents package had preexisting type drift (AgentTask vs SecurityFixTask); minimally handled to satisfy build without broad redesign.

Code Searches
- rg -n "security-fix-agent|SecurityScanner|performScan\(|\\bscan\(|SecurityScanResult|VulnerabilityReport|SecurityTrends|totalVulnerabilities" → located API usage and types across agents/testing/shared-types.
- rg -n "^### 5\\. " TODO.md → confirmed task details at TODO.md:118.
- rg -n "SecurityScan(Request|Result|Summary)|VulnerabilityReport|SecurityTrends" packages/shared-types/src/core-types.ts → found duplicate/older shapes.

Web Searches
- None (network restricted; internal docs only).

Implementation Notes
- Unified security types in shared-types:
  - Added `SecurityScanRequest` to `packages/shared-types/src/security.ts` with `entityIds`, `scanTypes`, `severity`.
  - Changed `VulnerabilityReport['trends']` to `SecurityTrends` and kept `summary.info`.
  - Stopped re-exporting `SecurityScanRequest|SecurityScanResult|VulnerabilityReport` from `core-types` in `packages/shared-types/src/index.ts`.
  - Removed duplicate security interfaces from `packages/shared-types/src/core-types.ts` (comment left referencing security.ts as source of truth).
- Updated reports generation:
  - `packages/testing/src/security/reports.ts`: `calculateVulnerabilityTrends()` now returns `SecurityTrends` with period/newIssues/resolvedIssues/averageResolutionTime/securityScore.
- Fixed agent API usage and minor typing:
  - `packages/agents/src/security-fix-agent.ts`: replaced `securityScanner.scan(...)` with `securityScanner.performScan(request, options)`; result handling updated. Narrowed `AgentTask` to `SecurityFixTask` via `as unknown as` to avoid unrelated type mismatch blocking build.
- Resolved a TS issue in `packages/testing/src/security/graph-utils.ts` by typing `headers` and removing generic type arg on reduce.

Validation Evidence
- Build command (cached where applicable):
  - `pnpm nx run shared-types:build && pnpm nx run testing:build && pnpm -r --filter @memento/agents build`
- Full output: logs/builds/2025-09-30/1655-task5-build.log
- Assertion: No TS errors found; agents build completed without errors.

Open Follow-ups
- Consider adding an `IncrementalScanResult` type to shared-types if incremental scans need to be shared outside testing (as noted in TODO).
- Longer-term: align `AgentType` union to include a dedicated security-fix agent type or adapt agent task routing to avoid `unknown` narrowing.
