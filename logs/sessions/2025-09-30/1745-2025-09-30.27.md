# Task & Definition
Align MCP server API calls with KnowledgeGraphService and DocumentationParser to match current package APIs and resolve build/type errors in apps/mcp-server/src/main.ts.

# Constraints/Risks
- No network access; rely on local code.
- Avoid wide refactors; keep MCP server thin.
- Acceptable to adjust request shapes minimally for type alignment.

# Code Searches
- cmd: rg -n "getRelationships\(|searchEntities\(|getDependencies\(|parseDocumentation\(" apps/mcp-server/src/main.ts
  - Expect: Locate mismatched API calls and line numbers.
  - Observed: Calls at analyze_code (getRelationships), search_codebase (searchEntities with type), get_dependencies (getDependencies), get_documentation (parseDocumentation).
- cmd: sed -n '1,360p' packages/knowledge/src/orchestration/KnowledgeGraphService.ts
  - Expect: Confirm method names and signatures.
  - Observed: getRelationships(query: RelationshipQuery), searchEntities(request: GraphSearchRequest), getEntityDependencies(entityId: string, options?: any).
- cmd: sed -n '520,980p' packages/knowledge/src/embeddings/DocumentationParser.ts
  - Expect: Confirm documentation sync API.
  - Observed: syncDocumentation(docsPath: string) is the public sync method; no parseDocumentation(path, format).

# Web Searches
- None (network disabled; N/A).

# Implementation Notes
- Updated MCP handlers:
  - analyze_code: pass RelationshipQuery object { fromEntityId, limit } to getRelationships.
  - search_codebase: map { query, entityTypes: [type] } when type !== 'all'.
  - get_dependencies: use kgService.getEntityDependencies(path, { maxDepth }).
  - get_documentation: call docParser.syncDocumentation(path) instead of parseDocumentation.
- File changed: apps/mcp-server/src/main.ts.

# Validation Evidence
- Build command: pnpm -r --filter mcp-server build > logs/latest-build.log 2>&1
- Acceptance checks: No TS errors at adjusted call sites; build succeeds.

# Open Follow-ups
- Consider importing RelationshipQuery type and removing 'as any' cast for stricter typing.
- Potential input validation: map unsupported 'type' values (e.g., 'variable', 'import') to nearest entityTypes or drop.
\n---\n[17:46Z] Build succeeded. Verified no TS errors for modified call sites. Log: logs/latest-build.log
