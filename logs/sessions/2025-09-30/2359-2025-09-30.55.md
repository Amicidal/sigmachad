Task & Definition
- Implement TODO 35: eliminate error-level eslint rule `security/detect-object-injection` in `@memento/sync`.
- Acceptance: `node scripts/run-nx.cjs run sync:lint` shows 0 errors from `security/detect-object-injection`; scoped eslint JSON has no severity 2 for that rule.

Constraints/Risks
- Keep changes focused; avoid large refactors. Prefer safe patterns (Maps, Object.fromEntries, Array.at) over brute-force disables; use narrow disables only when inputs are internal and validated.
- Monorepo limits (depth/import ceilings) apply; edits only in `packages/sync`.
- High lint output volume; capture logs to files.

Code Searches
- `sed -n` to open TODO.md and identify task 35 details.
- Reviewed prior lint log: `sed -n 1,200p logs/lints/2025-09-30/233908-nx-sync-lint.log` to list flagged locations.
- Inspected files/lines:
  - `nl -ba packages/sync/src/scm/ConflictResolution.ts:430` onwards (dynamic indexing in diff/prep helpers).
  - `nl -ba packages/sync/src/scm/GitService.ts:520-580` (status parsing loop).
  - `nl -ba packages/sync/src/synchronization/SynchronizationMonitoring.ts:240-300` (map → record export).
  - `nl -ba packages/sync/src/synchronization/SynchronizationCoordinator.ts:1288-1316` (batch worker using array indexing).
  - `nl -ba packages/sync/src/scm/RollbackCapabilities.ts:400-430` (reverse iteration using indexes).

Web Searches
- None. Local refactor guided by in-repo TODO and eslint rule intent.

Implementation Notes
- ConflictResolution.ts
  - Replaced object writes/reads via bracket indexing with entries+`Object.fromEntries` and Maps in `prepareForDiff`, `prepareValue`, and `computeObjectDiff`.
  - Rewrote `generateSignature` and `diffEquals` to avoid `diff[key]`/`a[key]` access; used sorted `Object.entries` and iterator lockstep.
- GitService.ts
  - Replaced index-based loop with `for (const line of lines.slice(1))`.
  - Switched `status[0/1]` to `status.charAt(0/1)`.
- SynchronizationMonitoring.ts
  - Converted Map->Record export to `Object.fromEntries` pipeline.
- SynchronizationCoordinator.ts
  - Eliminated `batch[current]` access inside function call; used `batch.at(idx)` and guard.
- RollbackCapabilities.ts
  - Replaced reverse index loop with `for (const entityChange of [...entities].reverse())`.

Validation Evidence
- Ran: `node scripts/run-nx.cjs run sync:lint > logs/lints/2025-09-30/235829-nx-sync-lint.log 2>&1`.
- Assertion: Tail shows `156 problems (0 errors, 156 warnings)`; no occurrences of `security/detect-object-injection` with severity 2.
  - Log: logs/lints/2025-09-30/235829-nx-sync-lint.log
- Intermediate runs:
  - logs/lints/2025-09-30/235659-nx-sync-lint.log (4 errors → reduced)
  - logs/lints/2025-09-30/235730-nx-sync-lint.log (1 error → reduced)

Open Follow-ups
- Numerous `@typescript-eslint/no-explicit-any` warnings across sync; candidate for separate cleanup task if prioritised.
- Consider extracting common diff/normalization utilities into a dedicated helper to consolidate patterns and tests.
