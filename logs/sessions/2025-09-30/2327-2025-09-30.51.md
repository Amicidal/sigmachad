Task & Definition
- Implement TODO 31: Resolve security/detect-object-injection in @memento/core utils by removing dynamic object/array bracket indexing in `packages/core/src/utils/{codeEdges.ts,embedding.ts}`. Ensure eslint reports 0 error-level findings for this rule and add a targeted test for the hoisting behavior.

Constraints/Risks
- Keep public APIs stable; avoid behavioral drift.
- No new deep paths (>3 levels). Use pnpm and vitest. Network access restricted; avoid real OpenAI calls.
- Prefer simple refactors over suppressing lints; add minimal tests.

Code Searches
- cmd: `rg -n "^### 31\\." TODO.md` -> located task entry.
- cmd: `rg -n "codeEdges|embedding" packages/core/src` -> confirmed files and exports.
- cmd: `nl -ba packages/core/src/utils/embedding.ts` -> inspected lines 228, 229, 271 flagged by eslint.
- cmd: `nl -ba packages/core/src/utils/codeEdges.ts` -> inspected line 275 dynamic hoist usage.

Web Searches
- None (not needed).

Implementation Notes
- embedding.ts:
  - Replaced `inputs[i]` and `response.data[i]` with safe iteration using `for (const [i, input] of inputs.entries())` and `response.data.at(i)` plus length guard; throws on mismatch or missing embedding.
  - Replaced dynamic `pricing[model]` with a `switch` in `getCostPerToken`.
- codeEdges.ts:
  - Removed dynamic hoist `rel[key] = md[k]` and replaced with explicit field-by-field assignments for the allowed whitelist, including legacy `param -> paramName` mapping.
- Tests:
  - Added `tests/normalizeCodeEdge.injection.test.ts` (vitest) to assert only allowed keys are hoisted and legacy param mapping works; ensures arbitrary `evil` key is not hoisted.

Validation Evidence
- Lint before: logs/lints/$(date -u +%F)/<time>-core-injection.log shows 3 errors in embedding.ts at 228, 229, 271.
- Lint after (targeted): logs/lints/$(date -u +%F)/<time>-core-injection-after.log -> 0 errors, warnings only.
- Lint after (utils dir): logs/lints/$(date -u +%F)/<time>-core-utils-full-eslint.log -> 0 errors, warnings only; no `security/detect-object-injection` errors present.
- Test: logs/tests/$(date -u +%F)/<time>-normalizeCodeEdge.log -> 1 test passed.

Open Follow-ups
- Optional: reduce @typescript-eslint/no-explicit-any warnings in both files by typing helper vars and refining `any` usages.
- Consider adding a small embedding batch test with a mocked OpenAI client to cover the new mismatch guard path.
