{
  "plugins": ["sonarjs"],
  "extends": ["plugin:sonarjs/recommended"],
  "parser": "@typescript-eslint/parser",
  "parserOptions": {
    "ecmaVersion": 2022,
    "sourceType": "module",
    "project": ["tsconfig.json", "packages/*/tsconfig.json"]
  },
  "rules": {
    // Cognitive Complexity - max 15
    "sonarjs/cognitive-complexity": ["error", 15],

    // Cyclomatic Complexity - max 10
    "complexity": ["error", 10],

    // Avoid duplicate code
    "sonarjs/no-duplicate-string": ["error", { "threshold": 3 }],
    "sonarjs/no-identical-functions": "error",

    // Code quality
    "sonarjs/no-collapsible-if": "error",
    "sonarjs/no-collection-size-mischeck": "error",
    "sonarjs/no-duplicated-branches": "error",
    "sonarjs/no-element-overwrite": "error",
    "sonarjs/no-empty-collection": "error",
    "sonarjs/no-extra-arguments": "error",
    "sonarjs/no-gratuitous-expressions": "error",
    "sonarjs/no-identical-conditions": "error",
    "sonarjs/no-identical-expressions": "error",
    "sonarjs/no-ignored-return": "error",
    "sonarjs/no-inverted-boolean-check": "error",
    "sonarjs/no-nested-switch": "error",
    "sonarjs/no-nested-template-literals": "warn",
    "sonarjs/no-one-iteration-loop": "error",
    "sonarjs/no-redundant-boolean": "error",
    "sonarjs/no-redundant-jump": "error",
    "sonarjs/no-same-line-conditional": "error",
    "sonarjs/no-small-switch": "warn",
    "sonarjs/no-unused-collection": "error",
    "sonarjs/no-use-of-empty-return-value": "error",
    "sonarjs/no-useless-catch": "error",
    "sonarjs/non-existent-operator": "error",
    "sonarjs/prefer-immediate-return": "warn",
    "sonarjs/prefer-object-literal": "warn",
    "sonarjs/prefer-single-boolean-return": "warn",
    "sonarjs/prefer-while": "warn",

    // Bug detection
    "sonarjs/no-all-duplicated-branches": "error",
    "sonarjs/no-empty-alternatives": "error",

    // TypeScript specific (when using TypeScript parser)
    "sonarjs/no-gratuitous-expressions": "error",
    "sonarjs/no-invariant-returns": "error"
  },
  "overrides": [
    {
      "files": ["*.test.ts", "*.test.js", "*.spec.ts", "*.spec.js"],
      "rules": {
        // Relax rules for test files
        "sonarjs/no-duplicate-string": "off",
        "sonarjs/cognitive-complexity": ["warn", 20]
      }
    }
  ]
}
